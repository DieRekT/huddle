## RoomBrief environment
##
## Copy to .env:
##   cp env.example .env
##
## Required:
# OpenAI API Key (required)
OPENAI_API_KEY=

# Public Base URL for QR codes/links (set for production, e.g., https://huddle.idview.org)
PUBLIC_BASE_URL=

# Enable OpenAI Realtime transcription (recommended for best accuracy)
# NOTE: Realtime mode is currently experimental; leave this as "false" unless youâ€™ve wired up
# the Realtime session + client flow end-to-end.
# REALTIME_ENABLED=true
##
## Server
PORT=8787
HOST=0.0.0.0
LOG_LEVEL=info
##
## If you're running behind Cloudflare Tunnel, set this to your HTTPS hostname.
## Example: PUBLIC_BASE_URL=https://roombrief.example.com
PUBLIC_BASE_URL=
##
## Cloudflare API Token (for tunnel management)
## Used for creating and managing Cloudflare tunnels programmatically.
## Get one from: https://dash.cloudflare.com/profile/api-tokens
## Create a token with Zone:Edit and Account:Cloudflare Tunnel:Edit permissions
CLOUDFLARE_API_TOKEN=
##
## Realtime Transcription (Option A - best accuracy)
## Set REALTIME_ENABLED=true to use OpenAI Realtime API for low-latency streaming transcription
## This removes chunk-edge damage and stabilizes live text, providing the big accuracy jump.
## Falls back to chunked transcription if Realtime is unavailable or disabled.
REALTIME_ENABLED=false
##
## Transcription
OPENAI_TRANSCRIBE_MODEL=gpt-4o-mini-transcribe
TRANSCRIBE_TEMPERATURE=0
## English-only by default. Set to "auto" if you want language detection.
OPENAI_TRANSCRIBE_LANGUAGE=en
TRANSCRIBE_RETRY_ATTEMPTS=3
TRANSCRIBE_CONTEXT_WORDS=50
## Phase 2.2: per-mic prompt stitching / rolling context
PROMPT_CONTEXT_MAX_CHARS=900
TRANSCRIBE_PROMPT_MAX_CHARS=1400
API_TIMEOUT_MS=30000
##
## Audio normalization (ffmpeg)
## IMPORTANT: default is **no filters**. Denoise/normalization can destroy consonants for ASR.
## If you want conservative filtering, set e.g.:
## FFMPEG_AUDIO_FILTER=highpass=f=80,lowpass=f=8000
FFMPEG_AUDIO_FILTER=
##
## Audio quality gate (skip quiet/too-short chunks; emits rate-limited audio_warning events)
## Lower values = more sensitive (picks up quieter/shorter speech)
## Optimized for iPad/iOS devices which often have lower mic sensitivity
MIN_WAV_SEC=0.4
MIN_WAV_RMS=0.004
## Preferred alias (takes precedence over MIN_WAV_RMS)
RMS_MIN=0.004
## Rate-limit audio warning events (ms)
AUDIO_WARN_COOLDOWN_MS=4000
## If 1, allow direct transcription when ffmpeg WAV conversion fails (can increase junk output)
ALLOW_DIRECT_TRANSCRIBE_FALLBACK=0
##
## Debug proof: dump what the server actually hears so you can listen (ffplay)
DEBUG_DUMP_WAV=0
DEBUG_DUMP_WAV_PATH=/tmp/huddle_debug.wav
DEBUG_DUMP_WAV_COOLDOWN_MS=10000
##
## Summaries
SUMMARY_INTERVAL_SEC=10
SUMMARY_LOOKBACK_SEC=120
TOPIC_SHIFT_CONFIDENCE_THRESHOLD=0.60
TOPIC_SHIFT_DURATION_SEC=8
## Room Signal Engine (RSE) for Read-the-Room
## Set USE_RSE_FOR_RTR=true to use RSE segments instead of raw transcripts
## This enables duplicate suppression, better tone inference, and confidence-gated behavior
USE_RSE_FOR_RTR=true
##
## Limits / safety
ROOM_TTL_MS=7200000
MAX_CHUNK_SIZE_BYTES=220000
MAX_TRANSCRIPTS=1000
RATE_LIMIT_CHUNKS_PER_MINUTE=100
TEMP_FILE_MAX_AGE_MS=3600000

